<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Ludwing D√≠az</title>
    <link rel="stylesheet" href="/projects/vlog/css/tutoriales.css"> 
    <link rel="shortcut icon" type="image/png" href="/assets/EmoteBulldog 28x28.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/css/dashboard.css"> 
</head>
<body>
    <header>
        <%- include('partials/header') %> 
    </header>

    <main class="container profile-dashboard-layout">
        <div id="messageBox" class="message-box" style="display: none;"></div>

        <aside class="profile-sidebar">
            <div class="profile-avatar-display">
               <!-- A√ëADIR ID A LA IMAGEN Y UN SRC INICIAL (puede ser vac√≠o o un placeholder) -->
           <img id="profileAvatarDisplay" src="/assets/default-avatar.png" alt="Avatar de Usuario" class="profile-avatar-large">
    <h3 id="usernameDisplaySidebar">Cargando...</h3>
    <p class="profile-email-sidebar" id="userEmailDisplaySidebar">Cargando...</p>
            </div>
            <nav class="profile-sub-nav">
                <a href="#" class="profile-nav-item" id="visionGeneralLink">
                    <i class="fas fa-home icon-overview"></i> Visi√≥n General
                </a>
                <a href="#" class="profile-nav-item" id="editProfileLink">
                    <i class="fas fa-user-edit icon-edit"></i> Editar Perfil
                </a>
                <a href="#" class="profile-nav-item" id="securityLink">
                    <i class="fas fa-shield-alt icon-security"></i> Seguridad
                </a>
                <a href="#" class="profile-nav-item" id="misComentariosLink">
                    <i class="fas fa-comments icon-comments"></i> Mis Comentarios
                </a>
            </nav>
        </aside>
     
        <section class="profile-main-content">

            <div id="profile-overview-section" class="content-card content-section">
                <h1>Bienvenido a tu Perfil, <span id="usernameDisplayMain">Cargando...</span>!</h1>
                
                <div class="profile-stats-grid">
                    <div class="stat-card">
                        <h4>Comentarios Publicados</h4>
                        <p class="stat-value">--</p> </div>
                    <div class="stat-card">
                        <h4>√öltima Actividad</h4>
                        <p class="stat-value">--</p>
                    </div>
                    <div class="stat-card">
                        <h4>Art√≠culos Vistos</h4>
                        <p class="stat-value">--</p>
                    </div>
                </div>

            
                <div class="card mt-4">
                    <h3>√öltimas 10 Entradas/Comentarios</h3>
                    <div id="commentsListOverview"> 
                        <p>Cargando tus √∫ltimas entradas...</p>
                    </div>
                </div>
            </div>
            
            <div id="edit-profile-section" class="content-card content-section" style="display: none;">
                <h2>Editar Perfil</h2>
                <div class="edit-profile-container">
                    <form id="editProfileForm">
                        <div class="form-group">
                            <label for="editUsername">Nombre de Usuario:</label>
                            <input type="text" id="editUsername" class="form-control" required minlength="3" aria-label="Nombre de usuario">
                        </div>

                         <!-- CAMPO PARA LA FOTO DE PERFIL -->
                        <div class="form-group">
                            <label for="profilePictureInput">Foto de Perfil:</label>
                            <input type="file" id="profilePictureInput" class="form-control" accept="image/*" aria-label="Foto de perfil">
                            <small class="form-text text-muted">Sube una nueva foto para tu perfil (Max 5MB).</small>
                        </div>
                        <!-- Los campos de contrase√±a se han movido a la secci√≥n de Seguridad -->
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                        <p id="editProfileMessage" class="message-box mt-3" style="display: none;"></p>
                    </form>
                </div>
            </div>

            <!-- ==================================================================== -->
            <!-- CONTENIDO DE LA SECCI√ìN DE SEGURIDAD (INCLUYE CAMBIO DE CONTRASE√ëA) -->
            <!-- ==================================================================== -->
            <div id="security-section" class="content-card content-section" style="display: none;">
                <div class="tutorial-content" data-section-id="security-profile-edit"> 
                    <h1>üîí Configuraci√≥n de Seguridad del Perfil</h1> 
                    <p>Gestiona las opciones de seguridad de tu cuenta para mantener tu informaci√≥n protegida.</p>
                    <hr>

                    <section class="step">
                        <h2>üîë Cambiar Contrase√±a</h2>
                        <p>Es recomendable cambiar tu contrase√±a regularmente para mejorar la seguridad de tu cuenta.</p>
                        <form id="change-password-form">
                            <div class="form-group">
                                <label for="current-password">Contrase√±a Actual:</label>
                                <input type="password" id="current-password" name="currentPassword" required autocomplete="current-password">
                            </div>
                            <div class="form-group">
                                <label for="new-password">Nueva Contrase√±a:</label>
                                <input type="password" id="new-password" name="newPassword" required autocomplete="new-password">
                                <small>La contrase√±a debe tener al menos 8 caracteres, incluyendo may√∫sculas, min√∫sculas, n√∫meros y s√≠mbolos.</small>
                            </div>
                            <div class="form-group">
                                <label for="confirm-new-password">Confirmar Nueva Contrase√±a:</label>
                                <input type="password" id="confirm-new-password" name="confirmNewPassword" required autocomplete="new-password">
                            </div>
                            <button type="submit" class="version-button">Cambiar Contrase√±a</button>
                            <p id="password-message" class="message-box" style="margin-top: 10px;"></p>
                        </form>
                    </section>

                    <section class="step">
                        <h2>üì± Autenticaci√≥n de Dos Factores (2FA)</h2>
                        <p>A√±ade una capa extra de seguridad a tu cuenta. Con 2FA, necesitar√°s un c√≥digo de tu tel√©fono adem√°s de tu contrase√±a para iniciar sesi√≥n.</p>
                        <p><strong>Estado actual:</strong> <span id="2fa-status">Desactivado</span></p>
                        <button id="toggle-2fa-button" class="version-button">Activar 2FA</button>
                        <p id="2fa-message" class="message-box" style="margin-top: 10px;"></p>
                    </section>

                    <section class="step">
                        <h2>üåê Sesiones Activas</h2>
                        <p>Revisa d√≥nde has iniciado sesi√≥n con tu cuenta y cierra las sesiones que no reconozcas.</p>
                        <div id="active-sessions-list">
                            <p>Cargando sesiones activas...</p>
                        </div>
                        <button id="logout-all-sessions-button" class="version-button" style="margin-top: 15px;">Cerrar todas las otras sesiones</button>
                        <p id="sessions-message" class="message-box" style="margin-top: 10px;"></p>
                    </section>

                    <section class="summary">
                        <h2>‚úÖ Consejos de Seguridad Adicionales</h2>
                        <ul>
                            <li>Utiliza contrase√±as √∫nicas y complejas para cada cuenta.</li>
                            <li>No compartas tu contrase√±a con nadie.</li>
                            <li>Mant√©n tu software y sistema operativo actualizados.</li>
                            <li>Ten cuidado con los correos electr√≥nicos y enlaces sospechosos (phishing).</li>
                        </ul>
                    </section>
                </div>
            </div>
            <!-- ==================================================================== -->
            <!-- FIN CONTENIDO DE LA SECCI√ìN DE SEGURIDAD -->
            <!-- ==================================================================== -->

            <div id="comments-section" class="content-card content-section" style="display: none;">
                <h2>Todos Mis Comentarios</h2>
                <div id="commentsListAll"> 
                    <p>Cargando todos tus comentarios...</p>
                </div>
            </div>

            <div id="protected-data-section" class="content-card content-section" style="display: none;">
                <h2>Mis Datos Protegidos</h2>
                <button id="fetchProtectedData" class="submit-button">Cargar mis datos (Protegido)</button>
                <p id="protectedMessage" style="margin-top: 15px;"></p>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Ludwing D√≠az. Todos los derechos reservados.</p>
    </footer>

    <script src="/projects/vlog/js/auth.js" defer></script> 
    <script src="/projects/vlog/js/theme-switcher.js"></script>
    <script src="/projects/vlog/js/diario.js" defer></script> 
</body>
</html>
